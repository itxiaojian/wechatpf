var EvPNG={ns:"EvPNG",imgSize:{},createVmlNameSpace:function(){if(document.namespaces&&!document.namespaces[this.ns]){document.namespaces.add(this.ns,"urn:schemas-microsoft-com:vml")}if(window.attachEvent){window.attachEvent("onbeforeunload",function(){EvPNG=null})}},createVmlStyleSheet:function(){var c=document.createElement("style");document.documentElement.firstChild.insertBefore(c,document.documentElement.firstChild.firstChild);var d=c.styleSheet;d.addRule(this.ns+"\\:*","{behavior:url(#default#VML)}");d.addRule(this.ns+"\\:shape","position:absolute;");d.addRule("img."+this.ns+"_sizeFinder","behavior:none; border:none; position:absolute; z-index:-1; top:-10000px; visibility:hidden;");this.styleSheet=d},readPropertyChange:function(){var c=event.srcElement;if(event.propertyName.search("background")!=-1||event.propertyName.search("border")!=-1){EvPNG.applyVML(c)}if(event.propertyName=="style.display"){var d=(c.currentStyle.display=="none")?"none":"block";for(var e in c.vml){c.vml[e].shape.style.display=d}}if(event.propertyName.search("filter")!=-1){EvPNG.vmlOpacity(c)}},vmlOpacity:function(c){if(c.currentStyle.filter.search("lpha")!=-1){var d=c.currentStyle.filter;d=parseInt(d.substring(d.lastIndexOf("=")+1,d.lastIndexOf(")")),10)/100;c.vml.color.shape.style.filter=c.currentStyle.filter;c.vml.image.fill.opacity=d}},handlePseudoHover:function(b){setTimeout(function(){EvPNG.applyVML(b)},1)},fix:function(c){var d=c.split(",");for(var e=0;e<d.length;e++){this.styleSheet.addRule(d[e],"behavior:expression(EvPNG.fixPng(this))")}},applyVML:function(b){b.runtimeStyle.cssText="";this.vmlFill(b);this.vmlOffsets(b);this.vmlOpacity(b);if(b.isImg){this.copyImageBorders(b)}},attachHandlers:function(g){var i=this;var j={resize:"vmlOffsets",move:"vmlOffsets"};if(g.nodeName=="A"){var k={mouseleave:"handlePseudoHover",mouseenter:"handlePseudoHover",focus:"handlePseudoHover",blur:"handlePseudoHover"};for(var f in k){j[f]=k[f]}}for(var l in j){g.attachEvent("on"+l,function(){i[j[l]](g)})}g.attachEvent("onpropertychange",this.readPropertyChange)},giveLayout:function(b){b.style.zoom=1;if(b.currentStyle.position=="static"){b.style.position="relative"}},copyImageBorders:function(c){var d={borderStyle:true,borderWidth:true,borderColor:true};for(var e in d){c.vml.color.shape.style[e]=c.currentStyle[e]}},vmlFill:function(g){if(!g.currentStyle){return}else{var h=g.currentStyle}for(var m in g.vml){g.vml[m].shape.style.zIndex=h.zIndex}g.runtimeStyle.backgroundColor="";g.runtimeStyle.backgroundImage="";var i=(h.backgroundColor=="transparent");var j=true;if(h.backgroundImage!="none"||g.isImg){if(!g.isImg){g.vmlBg=h.backgroundImage;g.vmlBg=g.vmlBg.substr(5,g.vmlBg.lastIndexOf('")')-5)}else{g.vmlBg=g.src}var k=this;if(!k.imgSize[g.vmlBg]){var l=document.createElement("img");k.imgSize[g.vmlBg]=l;l.className=k.ns+"_sizeFinder";l.runtimeStyle.cssText="behavior:none; position:absolute; left:-10000px; top:-10000px; border:none;";l.attachEvent("onload",function(){this.width=this.offsetWidth;this.height=this.offsetHeight;k.vmlOffsets(g)});l.src=g.vmlBg;l.removeAttribute("width");l.removeAttribute("height");document.body.insertBefore(l,document.body.firstChild)}g.vml.image.fill.src=g.vmlBg;j=false}g.vml.image.fill.on=!j;g.vml.image.fill.color="none";g.vml.color.shape.style.backgroundColor=h.backgroundColor;g.runtimeStyle.backgroundImage="none";g.runtimeStyle.backgroundColor="transparent"},vmlOffsets:function(h){var l=h.currentStyle;var o={W:h.clientWidth+1,H:h.clientHeight+1,w:this.imgSize[h.vmlBg].width,h:this.imgSize[h.vmlBg].height,L:h.offsetLeft,T:h.offsetTop,bLW:h.clientLeft,bTW:h.clientTop};var s=(o.L+o.bLW==1)?1:0;var t=function(b,e,g,i,c,f){b.coordsize=i+","+c;b.coordorigin=f+","+f;b.path="m0,0l"+i+",0l"+i+","+c+"l0,"+c+" xe";b.style.width=i+"px";b.style.height=c+"px";b.style.left=e+"px";b.style.top=g+"px"};t(h.vml.color.shape,(o.L+(h.isImg?0:o.bLW)),(o.T+(h.isImg?0:o.bTW)),(o.W-1),(o.H-1),0);t(h.vml.image.shape,(o.L+o.bLW),(o.T+o.bTW),(o.W),(o.H),1);var u={X:0,Y:0};var w=function(e,f){var g=true;switch(f){case"left":case"top":u[e]=0;break;case"center":u[e]=0.5;break;case"right":case"bottom":u[e]=1;break;default:if(f.search("%")!=-1){u[e]=parseInt(f)*0.01}else{g=false}}var i=(e=="X");u[e]=Math.ceil(g?((o[i?"W":"H"]*u[e])-(o[i?"w":"h"]*u[e])):parseInt(f));if(u[e]==0){u[e]++}};for(var a in u){w(a,l["backgroundPosition"+a])}h.vml.image.fill.position=(u.X/o.W)+","+(u.Y/o.H);var x=l.backgroundRepeat;var y={T:1,R:o.W+s,B:o.H,L:1+s};var z={X:{b1:"L",b2:"R",d:"W"},Y:{b1:"T",b2:"B",d:"H"}};if(x!="repeat"){var d={T:(u.Y),R:(u.X+o.w),B:(u.Y+o.h),L:(u.X)};if(x.search("repeat-")!=-1){var A=x.split("repeat-")[1].toUpperCase();d[z[A].b1]=1;d[z[A].b2]=o[z[A].d]}if(d.B>o.H){d.B=o.H}h.vml.image.shape.style.clip="rect("+d.T+"px "+(d.R+s)+"px "+d.B+"px "+(d.L+s)+"px)"}else{h.vml.image.shape.style.clip="rect("+y.T+"px "+y.R+"px "+y.B+"px "+y.L+"px)"}},fixPng:function(f){f.style.behavior="none";if(f.nodeName=="BODY"||f.nodeName=="TD"||f.nodeName=="TR"){return}f.isImg=false;if(f.nodeName=="IMG"){if(f.src.toLowerCase().search(/\.png$/)!=-1){f.isImg=true;f.style.visibility="hidden"}else{return}}else{if(f.currentStyle.backgroundImage.toLowerCase().search(".png")==-1){return}}var g=EvPNG;f.vml={color:{},image:{}};var h={shape:{},fill:{}};for(var k in f.vml){for(var j in h){var i=g.ns+":"+j;f.vml[k][j]=document.createElement(i)}f.vml[k].shape.stroked=false;f.vml[k].shape.appendChild(f.vml[k].fill);f.parentNode.insertBefore(f.vml[k].shape,f)}f.vml.image.shape.fillcolor="none";f.vml.image.fill.type="tile";f.vml.color.fill.on=false;g.attachHandlers(f);g.giveLayout(f);g.giveLayout(f.offsetParent);g.applyVML(f)}};try{document.execCommand("BackgroundImageCache",false,true)}catch(r){}EvPNG.createVmlNameSpace();EvPNG.createVmlStyleSheet();